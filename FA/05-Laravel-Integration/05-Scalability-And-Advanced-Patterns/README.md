<div dir="rtl">

# ุจุฎุด ตุ ุฏุฑุณ ต: ููุงุณโูพุฐุฑ ู ุงูฺฏููุง ูพุดุฑูุชู ุฏุฑ ูุงุฑุงูู

ููุช ุงูพูฺฉุดู ุดูุง ุฑุดุฏ ูโฺฉูุฏ ู ุชุฑุงูฺฉ ุจุงูุง ูโุฑูุฏุ ฺฉุฏูุง ฺฉู ุจุฑุง ฑฐฐ ฺฉุงุฑุจุฑ ุฎูุจ ฺฉุงุฑ ูโฺฉุฑุฏูุฏุ ูุงฺฏูุงู ุจุงุนุซ ฺฉูุฏ ุง ฺฉุฑุด ฺฉุฑุฏู ุณุฑูุฑ ูโุดููุฏ. ุฏุฑ ุงู ุฏุฑุณุ ุงุฏ ูโฺฏุฑู ฺฉู ฺฺฏููู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑูุง ุฏุงุฎู ูุงุฑุงููุ ุงูพูฺฉุดู ุฑุง ุจุฑุง ูุฏุฑุช ุจุงุฑ ุณูฺฏู ู ุฏุงุฏูโูุง ุญุฌู ุขูุงุฏู ฺฉูู.

-----

## ฑ. ุชูุฒุน ุจุงุฑ ุจุง Read/Write Splitting

ุฏุฑ ูุตู ด ุจุง ููููู **Replication (Master-Slave)** ุขุดูุง ุดุฏู. ูุงุฑุงูู ุจู ุตูุฑุช ูพุดโูุฑุถ ุงุฒ ุงู ูุนูุงุฑ ูพุดุชุจุงู ูโฺฉูุฏ ู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุจุงุฑ ุณูฺฏู ฺฉูุฆุฑโูุง `SELECT` ุฑุง ุจู ฺูุฏู ุณุฑูุฑ Slave ุชูุฒุน ฺฉูุฏ.

**ุชูุธูุงุช ุฏุฑ `config/database.php`:**
ฺฉุงูุณุช ฺฉุงูฺฉุดู mysql ุฎูุฏ ุฑุง ุจู ุดฺฉู ุฒุฑ ุชุบุฑ ุฏูุฏ ุชุง ุณุฑูุฑูุง ุฎูุงูุฏู (Read) ู ููุดุชู (Write) ุฌุฏุง ุดููุฏ:

<div dir="ltr">

```php
'mysql' => [
    'read' => [
        'host' => ['192.168.1.2', '192.168.1.3'], // (ุชูุฒุน ุจุงุฑ) Slave ุขุฏุฑุณ ุณุฑูุฑูุง
    ],
    'write' => [
        'host' => ['192.168.1.1'], // (ููุท ููุดุชู) Master ุขุฏุฑุณ ุณุฑูุฑ
    ],
    'sticky'    => true, // <--- ูฺฉุชู ุญุงุช!
    'driver'    => 'mysql',
    // ...
],
```
</div>

**ุฌุงุฏู `sticky => true` (ุญู ูุดฺฉู ุชุงุฎุฑ):**
ููุงูุทูุฑ ฺฉู ูโุฏุงููุ ููฺฏุงูโุณุงุฒ ุฏุงุฏู ุจู Master ู Slave ููฺฉู ุงุณุช ฺูุฏ ููโุซุงูู ุทูู ุจฺฉุดุฏ (Replication Lag).
ฺฏุฒูู `sticky` ุจู ูุงุฑุงูู ูโฺฏูุฏ: *"ุงฺฏุฑ ฺฉุงุฑุจุฑ ุฏุฑ ุงู ุฏุฑุฎูุงุณุช (Request) ฺุฒ ุฏุฑ ุฏุชุงุจุณ ููุดุชุ ุจูุงูุงุตูู ุจุนุฏ ุงุฒ ุขูุ ุชูุงู ุฎูุงูุฏูโูุงุด ุฑุง ูู ุงุฌุจุงุฑุงู ุงุฒ ุณุฑูุฑ Master ุงูุฌุงู ุจุฏู."*
ุงู ฺฉุงุฑ ุชุถูู ูโฺฉูุฏ ฺฉู ฺฉุงุฑุจุฑ ููุดู ุชุบุฑุงุช ุฎูุฏุด ุฑุง ุจูุงูุงุตูู ูโุจูุฏ ู ุจุง ูุดฺฉู ุฏุงุฏูโูุง ูุฏู ููุงุฌู ููโุดูุฏ.

-----

## ฒ. ูุฏุฑุช ุญุงูุธู ุฏุฑ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุญุฌู

ูุฑุถ ฺฉูุฏ ูโุฎูุงูุฏ ุงูู ุจุฑุง ุชูุงู ฑฐฐ,ฐฐฐ ฺฉุงุฑุจุฑ ุณุงุช ุงุฑุณุงู ฺฉูุฏ. ฺฉุฏ ุฒุฑ ฺฉ ูุงุฌุนู ุงุณุช:

**โ ุฑูุด ุบูุท (ูุตุฑู ุชูุงู RAM ุณุฑูุฑ):**

<div dir="ltr">

```php
$users = User::all(); // ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ RAM ุชูุงู ฑฐฐ ูุฒุงุฑ ุฑฺฉูุฑุฏ ุฏุฑ ฺฉ ูุญุธู ุฏุฑ
foreach ($users as $user) {
    // ...
}
```
</div>

ุงู ฺฉุฏ ุจุงุนุซ ุฎุทุง `Allowed memory size exhausted` ูโุดูุฏ.

**โ ุฑูุด ุตุญุญ ฑ: ุงุณุชูุงุฏู ุงุฒ `()chunk`**
ุงู ูุชุฏ ุฏุงุฏูโูุง ุฑุง ุชฺฉูโุชฺฉู (ูุซูุงู ฑฐฐฐ ุชุง ฑฐฐฐ ุชุง) ูุงฺฉุด ู ูพุฑุฏุงุฒุด ูโฺฉูุฏ.

<div dir="ltr">

```php
User::chunk(1000, function ($users) {
    foreach ($users as $user) {
        // ูพุฑุฏุงุฒุด ฑฐฐฐ ฺฉุงุฑุจุฑ
    }
}); // ุจุนุฏ ุงุฒ ูุฑ ุชฺฉูุ ุญุงูุธู ุขุฒุงุฏ ูโุดูุฏ
```

</div>

**โ ุฑูุด ุตุญุญ ฒ: ุงุณุชูุงุฏู ุงุฒ `()cursor` (ุจุฑุง ุณุฑุนุช ุจุงูุงุชุฑ)**
ุงฺฏุฑ ููุท ูโุฎูุงูุฏ ุฏุงุฏูโูุง ุฑุง ุจุฎูุงูุฏ ู ูุงุฒ ุจู ุขูพุฏุช ุขูโูุง ูุฏุงุฑุฏุ `cursor` ุงุฒ `chunk` ูู ุจูููโุชุฑ ุงุณุช. ุงู ูุชุฏ ุงุฒ ูุงุจูุช **PHP Generators** ุงุณุชูุงุฏู ูโฺฉูุฏ ู ููุท **ฺฉ ุฑฺฉูุฑุฏ** ุฑุง ุฏุฑ ูุฑ ูุญุธู ุฏุฑ ุญุงูุธู ูฺฏู ูโุฏุงุฑุฏ.

<div dir="ltr">

```php
foreach (User::cursor() as $user) {
    // ูพุฑุฏุงุฒุด ฺฉุงุฑุจุฑ
}
```

</div>

-----

## ณ. ฺฉุด ฺฉุฑุฏู ููุดููุฏ ฺฉูุฆุฑโูุง

ุณุฑุนโุชุฑู ฺฉูุฆุฑุ ฺฉูุฆุฑ ุงุฌุฑุง ูุดุฏู ุงุณุช. ูุงุฑุงูู ุจุง ูุชุฏ `Cache::remember` ุงูฺฏู ฺฉุด ฺฉุฑุฏู ุฑุง ุจุณุงุฑ ุณุงุฏู ฺฉุฑุฏู ุงุณุช.

**ุณูุงุฑู:** ูุญุงุณุจูโ ฺฏุฒุงุฑุด ูุฑูุด ุฑูุฒุงูู ุจุณุงุฑ ุณูฺฏู ุงุณุช.

<div dir="ltr">

```php
$salesReport = Cache::remember('daily_sales', 3600, function () {
    // ุงู ฺฉูุฆุฑ ุณูฺฏู ููุท ฺฉ ุจุงุฑ ุงุฌุฑุง ูโุดูุฏ
    // ู ูุชุฌู ุขู ุจุฑุง ณถฐฐ ุซุงูู (ฺฉ ุณุงุนุช) ุฏุฑ ุฑุฏุณ ุฐุฎุฑู ูโุดูุฏ.
    return DB::table('orders')
        ->selectRaw('SUM(amount) as total, date(created_at) as day')
        ->groupBy('day')
        ->get();
});
```

</div>

ุฏุฑ ุฏุฑุฎูุงุณุชโูุง ุจุนุฏุ ูุงุฑุงูู ูุณุชููุงู ุฏุงุฏู ุฑุง ุงุฒ ฺฉุด (Redis) ูโุฎูุงูุฏ ู ุงุตูุงู ุจู ุฏุชุงุจุณ ูุชุตู ููโุดูุฏ.

-----

### ุฎูุงุตู ุงุณุชุฑุงุชฺโูุง ููุงุณโูพุฐุฑ:

1.  **ุชุฑุงูฺฉ ุฎูุงูุฏู ุจุงูุงุณุชุ** ุงุฒ ฺฉุงููฺฏ `read/write` ุฏุฑ ูุงุฑุงูู ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ูุดุงุฑ `SELECT` ูุง ุฑู ุณุฑูุฑูุง Slave ูพุฎุด ุดูุฏ.
2.  **ุญุฌู ุฏุงุฏูโูุง ุจุงูุงุณุชุ** ูุฑฺฏุฒ ุงุฒ `()all` ุง `()get` ุจุฑุง ุฌุฏุงูู ุจุฒุฑฺฏ ุงุณุชูุงุฏู ูฺฉูุฏ. ููุดู ุงุฒ `()chunk` ุง `()cursor` ุงุณุชูุงุฏู ฺฉูุฏ.
3.  **ฺฉูุฆุฑโูุง ุชฺฉุฑุงุฑ ู ุณูฺฏู ูุณุชูุฏุ** ูุชุฌู ุฑุง ุจุง `Cache::remember` ฺฉุด ฺฉูุฏ.

-----

[โฉ ุฏุฑุณ ูุจู: ุงุจุฒุงุฑูุง ุฏุจุงฺฏ](../04-Debugging-Tools/README.md) | [๐ผ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช ูุตู](../README.md) | [ูุตู ุจุนุฏ: ฺฉูพุงุฑฺูโุณุงุฒ ุจุง ูุฑุฏูพุฑุณ โช](../../06-WordPress-Integration/README.md)


</div>
