<div dir="rtl">

# ุจุฎุด ตุ ุฏุฑุณ ฑ: ุจูููโุณุงุฒ Eloquent ู ุญู ูุดฺฉู N+1 Query

ูุงุฑุงูู ุจุง ORM ูุฏุฑุชููุฏ ุฎูุฏ ุนู **Eloquent**ุ ฺฉุงุฑ ุจุง ุฏุชุงุจุณ ุฑุง ูููโุงูุนุงุฏู ุณุงุฏู ู ูุฐุชโุจุฎุด ูโฺฉูุฏ. ุงูุง ุงู ุณุงุฏฺฏุ ุงฺฏุฑ ุจุง ุฏูุช ุงุณุชูุงุฏู ูุดูุฏุ ูโุชูุงูุฏ ุจู ฺฉ ุงุฒ ุดุงุนโุชุฑู ู ูุฎุฑุจโุชุฑู ูุดฺฉูุงุช ุนููฺฉุฑุฏ ููุฌุฑ ุดูุฏ: **ูุดฺฉู N+1 Query**.

### ูุดฺฉู N+1 Query ฺุณุชุ

ุงู ูุดฺฉู ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ุดูุง ุงุจุชุฏุง ูุณุช ุงุฒ ุขุชูโูุง ุฑุง ุงุฒ ุฏุชุงุจุณ ูโฺฏุฑุฏ (**ฺฉ ฺฉูุฆุฑ ุงูู**) ู ุณูพุณ ุฏุฑ ฺฉ ุญูููุ ุจุฑุง ุจู ุฏุณุช ุขูุฑุฏู ุงุทูุงุนุงุช ูุฑุชุจุท ุจุง **ูุฑ ฺฉุฏุงู** ุงุฒ ุขู ุขุชูโูุงุ ฺฉ ฺฉูุฆุฑ ุฌุฏุงฺฏุงูู ุงุฌุฑุง ูโฺฉูุฏ (**N ฺฉูุฆุฑ ุงุถุงูู**).

**ุณูุงุฑู ฺฉูุงุณฺฉ:** ููุงุด ูุณุช ูพุณุชโูุง ูุจูุงฺฏ ุจู ููุฑุงู ูุงู ููุณูุฏู ูุฑ ูพุณุช.

* ุฌุฏูู `posts` (ุจุง ุณุชูู `user_id`)
* ุฌุฏูู `users`

**ฺฉุฏ ุขุณุจโูพุฐุฑ (ุฑูุด N+1):**
<div dir="ltr">

```php
// Controller
$posts = Post::all(); // <-- SELECT * FROM posts : ฺฉูุฆุฑ ุดูุงุฑูฑ 

// Blade View
@foreach ($posts as $post)
    // ุจุฑุง ูุฑ ูพุณุชุ ฺฉ ฺฉูุฆุฑ ุฌุฏุงฺฏุงูู ุจุฑุง ูพุฏุง ฺฉุฑุฏู ููุณูุฏู ุงุฌุฑุง ูโุดูุฏ!
    <p>{{ $post->title }} by {{ $post->user->name }}</p> // <-- SELECT * FROM users WHERE id = ? : N ฺฉูุฆุฑ ุงุถุงูู  
@endforeach
```
</div>

ุงฺฏุฑ ุดูุง ฑฐฐ ูพุณุช ุฏุงุดุชู ุจุงุดุฏุ ุงู ฺฉุฏ **ฑฐฑ ฺฉูุฆุฑ** ุจู ุฏุชุงุจุณ ุงุฑุณุงู ูโฺฉูุฏ! ุงู ูุงุฌุนูโุจุงุฑ ุงุณุช ู ุจุง ุงูุฒุงุด ุชุนุฏุงุฏ ูพุณุชโูุงุ ุตูุญู ุดูุง ุจู ุดุฏุช ฺฉูุฏ ูโุดูุฏ.

---

### ## ุฑุงูโุญู: ุจุงุฑฺฏุฐุงุฑ ูุดุชุงูุงูู (Eager Loading)

ุฑุงูโุญู ุงู ูุดฺฉูุ ุงุณุชูุงุฏู ุงุฒ ูุชุฏ `with()` ุฏุฑ Eloquent ุงุณุช. Eager Loading ุจู ูุงุฑุงูู ูโฺฏูุฏ: "ููุช ูพุณุชโูุง ุฑุง ูุงฺฉุด ูโฺฉูุ ูู ูโุฏุงูู ฺฉู ุจู ุงุทูุงุนุงุช ููุณูุฏฺฏุงู ุขูโูุง ูู ูุงุฒ ุฎูุงูู ุฏุงุดุช. ูุทูุงู ุชูุงู ููุณูุฏฺฏุงู ููุฑุฏ ูุงุฒ ุฑุง ููุท ุจุง **ฺฉ ฺฉูุฆุฑ ุงุถุงูู**ุ ููู ุฑุง ุจุง ูู ูุงฺฉุด ฺฉู."

**ฺฉุฏ ุจููู ุดุฏู (ุจุง Eager Loading):**

<div dir="ltr">

```php
// Controller
$posts = Post::with('user')->get(); // <-- ุฌุงุฏู ุงูุฌุง ุงุชูุงู ูโุงูุชุฏ

// Blade View (ุจุฏูู ูฺ ุชุบุฑ)
@foreach ($posts as $post)
    <p>{{ $post->title }} by {{ $post->user->name }}</p>
@endforeach
```
</div>

ุงู ฺฉุฏ ุจููู ุดุฏูุ ููุท **ฒ ฺฉูุฆุฑ** ุจู ุฏุชุงุจุณ ุงุฑุณุงู ูโฺฉูุฏุ ููู ูุณุช ฑฐฐ ูพุณุช ุฏุงุดุชู ุจุงุดุฏ ุง ฑฐฐฐ ุชุง:

**ุข) `SELECT * FROM posts`**

**ุจ) `SELECT * FROM users WHERE id IN (1, 2, 5, ...)`** (ุชูุงู user_id ูุง ููุฑุฏ ูุงุฒ ุฑุง ุฏุฑ ฺฉ ฺฉูุฆุฑ ุฌูุน ูโฺฉูุฏ)

---

### ## ุงุจุฒุงุฑูุง ุชุดุฎุต N+1 Query

ฺฺฏููู ุจูููู ฺฉู ุฏุฑ ุจุฑูุงูู ูุง ูุดฺฉู N+1 ูุฌูุฏ ุฏุงุฑุฏุ

* ุข) **Laravel Debugbar:** ุงู ูพฺฉุฌ ูุญุจูุจุ ฺฉ ููุงุฑ ุงุจุฒุงุฑ ุฏุฑ ูพุงู ุตูุญู ุดูุง ุงุถุงูู ูโฺฉูุฏ ฺฉู ุชูุงู ฺฉูุฆุฑโูุง ุงุฌุฑุง ุดุฏู ุฏุฑ ุขู ุฏุฑุฎูุงุณุช ุฑุง ุจู ุดูุง ูุดุงู ูโุฏูุฏ. ุงฺฏุฑ ุฏุฑ ุชุจ "Queries" ุชุนุฏุงุฏ ุฒุงุฏ ฺฉูุฆุฑ ุชฺฉุฑุงุฑ ุฏุฏุฏุ ุจู ุงุญุชูุงู ุฒุงุฏ ุจุง ูุดฺฉู N+1 ููุงุฌู ูุณุชุฏ.
* ุจ) **Laravel Telescope:** ุงุจุฒุงุฑ ุฏุจุงฺฏ ุฑุณู ูุงุฑุงูู ฺฉู ููุง ุฌุงูุนโุชุฑ ู ุฏููโุชุฑ ุงุฒ ฺฉูุฆุฑโูุงุ ุฏุฑุฎูุงุณุชโูุง ู... ุงุฑุงุฆู ูโุฏูุฏ.

> **ูุงููู ุทูุง:** ููุดู ููฺฏุงู ฺฉุงุฑ ุจุง ุฑูุงุจุท Eloquent ุฏุฑ ุญูููโูุงุ ุงุฒ ุฎูุฏ ุจูพุฑุณุฏ: "ุขุง ูู ุงูุฌุง ุฏุฑ ุญุงู ุงุฌุงุฏ ฺฉ ูุดฺฉู N+1 ูุณุชูุ". ุจู ุตูุฑุช ูพุดโูุฑุถุ ููุดู ุงุฒ `()with` ุงุณุชูุงุฏู ฺฉูุฏ ูฺฏุฑ ุงูฺฉู ุฏูู ุจุฑุง ุนุฏู ุงุณุชูุงุฏู ุงุฒ ุขู ุฏุงุดุชู ุจุงุดุฏ.

---
[โฉ ูุตู ูุจู: ูุฏุฑุช ู ููุงุณโูพุฐุฑ](../../04-Admin-And-Scaling/README.md) | [๐ผ ุจุงุฒฺฏุดุช ุจู ููุฑุณุช ูุตู](../README.md) | [๐ ฺฉุฏ ุบุฑุจููู](examples/BadPractice.php) / [๐ ฺฉุฏ ุจููู](examples/GoodPractice.php) | [ุฏุฑุณ ุจุนุฏ: Query Builder ู Raw Expressions โช](../02-Query-Builder-And-Raw/README.md)

</div>
